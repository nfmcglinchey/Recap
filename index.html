<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valvoline Training Recap</title>
    <link rel="stylesheet" href="styles.css?v=2" />

    <!-- PDF Generation Library -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

    <!-- PizZip -->
    <script defer src="https://cdn.jsdelivr.net/npm/pizzip@3.0.5/dist/pizzip.min.js"></script>

    <!-- ✅ Use Docxtemplater from CDN -->
    <script defer src="https://unpkg.com/docxtemplater@3.36.0/build/docxtemplater.js"></script>

    <!-- FileSaver -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <!-- Your local JS -->
    <script defer src="template_base64.js"></script>
    <script defer src="script.js"></script>
  </head>
  <body>
    <!-- Instruction Modal -->
    <div id="instructionModal" class="modal">
      <div class="modal-content">
        <button id="darkModeToggle">Toggle Dark Mode</button>
        <h2>Please Read Before Using the Recap Template</h2>
        <p>
          This template is designed to help you draft a concise recap for the account(s) you visited.
          Fill in all required fields, then click "Generate PDF" or "Generate Word" to create your document.
        </p>
        <p><strong>If this was a one‑off visit with no training request, click "Non‑Scheduled".</strong></p>
        <button onclick="closeModal('non-scheduled')">Non‑Scheduled</button>
        <p><strong>If this was a regularly scheduled visit, click "Scheduled".</strong></p>
        <button onclick="closeModal('scheduled')">Scheduled</button>
      </div>
    </div>

    <!-- Account Type Modal -->
    <div id="accountTypeModal" class="modal" style="display:none;">
      <div class="modal-content">
        <h2>What type of account is this for?</h2>
        <div class="radio-row">
          <label><input type="radio" name="accountType" value="Strategic"><span>Strategic</span></label>
          <label><input type="radio" name="accountType" value="Key"><span>Key</span></label>
          <label><input type="radio" name="accountType" value="Regional"><span>Regional</span></label>
          <label><input type="radio" name="accountType" value="Dealership"><span>Dealership</span></label>
        </div>
        <div class="modal-buttons">
          <button onclick="confirmAccountType()">OK</button>
        </div>
      </div>
    </div>

    <!-- Form -->
    <div class="container">
      <div class="header">
        <p>Date: <span id="currentDate"></span></p>
      </div>
      <h2>Training Recap</h2>

      <label>Account Name:</label>
      <input type="text" id="accountName" placeholder="Enter Account Name" />

      <label>Attention:</label>
      <textarea id="attention" rows="2"></textarea>

      <label>CC:</label>
      <textarea id="cc" rows="3"></textarea>

      <label>Audience Name:</label>
      <input type="text" id="audienceName" placeholder="Audience Name" />

      <label>Personalized Opening:</label>
      <textarea id="opening"></textarea>

      <label>Locations Visited:</label>
      <textarea id="locations"></textarea>

      <label>Topics Covered:</label>
      <textarea id="topics"></textarea>

      <label>Training Type & Headcount:</label>
      <textarea id="trainingType"></textarea>

      <label>Key Achievements:</label>
      <textarea id="achievements"></textarea>

      <label>Opportunities for Improvement:</label>
      <textarea id="opportunities"></textarea>

      <label>Follow‑Ups:</label>
      <textarea id="followUps"></textarea>

      <label>Personalized Closing:</label>
      <textarea id="closing"></textarea>

      <button id="emailButton" onclick="sendEmail()">Generate Email</button>
      <button id="wordButton" onclick="generateWord()">Generate Word</button>
    </div>

    <!-- Hidden PDF Letter Container -->
    <div id="pdfLetter" style="display:none;"></div>
  </body>
</html>
