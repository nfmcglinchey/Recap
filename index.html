<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valvoline Training Recap</title>
    <link rel="stylesheet" href="styles.css?v=2" />

   <!-- PDF Generation Library -->
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

<!-- PizZip first -->
<script defer src="https://cdn.jsdelivr.net/npm/pizzip@3.0.5/dist/pizzip.min.js"></script>

<!-- Docxtemplater second -->
<script defer src="https://cdn.jsdelivr.net/npm/docxtemplater@latest/build/docxtemplater-latest.min.js"></script>

<!-- FileSaver third -->
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<!-- Your custom JS last -->
<script defer src="script.js"></script>
    
  </head>
  <body>
    <!-- Instruction Modal -->
    <div id="instructionModal" class="modal">
      <div class="modal-content">
        <button id="darkModeToggle">Toggle Dark Mode</button>
        <h2>Please Read Before Using the Recap Template</h2>
        <p>
          This template is designed to help you draft a concise recap for the account(s) you visited.
          Fill in all required fields, then click "Generate PDF" or "Generate Word" to create your document.
        </p>
        <p><strong>If this was a one‑off visit with no training request, click "Non‑Scheduled".</strong></p>
        <button onclick="closeModal('non-scheduled')">Non‑Scheduled</button>
        <p><strong>If this was a regularly scheduled visit, click "Scheduled".</strong></p>
        <button onclick="closeModal('scheduled')">Scheduled</button>
      </div>
    </div>
    
    <!-- Account Type Modal -->
    <div id="accountTypeModal" class="modal" style="display:none;">
      <div class="modal-content">
        <h2>What type of account is this for?</h2>
        <div class="radio-row">
          <label><input type="radio" name="accountType" value="Strategic"><span>Strategic</span></label>
          <label><input type="radio" name="accountType" value="Key"><span>Key</span></label>
          <label><input type="radio" name="accountType" value="Regional"><span>Regional</span></label>
          <label><input type="radio" name="accountType" value="Dealership"><span>Dealership</span></label>
        </div>
        <div class="modal-buttons">
          <button onclick="confirmAccountType()">OK</button>
        </div>
      </div>
    </div>
    
    <!-- Visible Form Container -->
    <div class="container">
      <div class="header">
        <p>Date: <span id="currentDate"></span></p>
      </div>
      <h2>Training Recap</h2>
      
      <label>Account Name:</label>
      <input type="text" id="accountName" placeholder="Enter Account Name">
      
      <label>Attention:</label>
      <textarea id="attention" rows="2"></textarea>
      
      <label>CC:</label>
      <textarea id="cc" rows="3"></textarea>
      
      <label>Audience Name:</label>
      <input type="text" id="audienceName" placeholder="Audience Name">
      
      <label>Personalized Opening:</label>
      <textarea id="opening" placeholder="I appreciate your support this week while I visited your district. I wanted to take a moment to express my gratitude for the opportunity to conduct training sessions at the following location(s):"></textarea>
      
      <label>Locations Visited:</label>
      <textarea id="locations" placeholder="• List the locations you visited:"></textarea>
      
      <label>Topics Covered:</label>
      <textarea id="topics" placeholder="• What topics were covered in your training visit?"></textarea>
      
      <label>Training Type & Headcount:</label>
      <textarea id="trainingType" placeholder="• Type of training (in‑store/ classroom) and total headcount."></textarea>
      
      <label>Key Achievements:</label>
      <textarea id="achievements" placeholder="• Enter visit details."></textarea>
      
      <label>Opportunities for Improvement:</label>
      <textarea id="opportunities" placeholder="• Enter opportunities for improvement."></textarea>
      
      <label>Follow‑Ups:</label>
      <textarea id="followUps" placeholder="• Enter Follow ups and the party responsible."></textarea>
      
      <label>Personalized Closing:</label>
      <textarea id="closing" placeholder="Once again, I would like to express my gratitude for the opportunity to conduct these training sessions at [Location 1], [Location 2], and [Location 3]. If there is anything else you need or if you have any questions, please don't hesitate to reach out."></textarea>
      
      <button id="pdfButton" onclick="generatePDF()" disabled>Generate PDF</button>
      <button id="emailButton" onclick="sendEmail()" disabled>Generate Email</button>
      <button id="wordButton" onclick="generateWord()" disabled>Generate Word</button>
    </div>
    
<!-- Hidden PDF Letter Container -->
<div id="pdfLetter" style="position:absolute; left:-9999px; top:0;">
  <div style="
    font-family: Arial, sans-serif;
    font-size: 11pt;
    line-height: 1.45;
    padding: 1in;
    width: 8.5in;
    min-height: 11in;
    box-sizing: border-box;
    margin: 0 auto;
    color: black;
  ">

    <!-- Header: FTS Info + Logo/Date -->
    <table style="width: 100%; table-layout: fixed; font-family: Arial, sans-serif; font-size: 9pt; line-height: 1.3; margin-bottom: 12pt; border-collapse: collapse;">
      <tr>
        <td style="width: 4.25in; vertical-align: top;">
          <p style="margin: 0;"><span id="pdfFTSName">Neal McGlinchey</span></p>
          <p style="margin: 0;">Field Training Specialist</p>
          <p style="margin: 0;">Mobile: <span id="pdfFTSPhone">(1) 678-278-5100</span></p>
          <p style="margin: 0;"><span id="pdfFTSEmail">NFMcGlinchey@valvolineglobal.com</span></p>
        </td>
        <td style="text-align: right; vertical-align: top;">
          <img src="https://raw.githubusercontent.com/nfmcglinchey/Recap/main/GBL_Valvoline_Logo_positive_RGB.jpg" alt="Valvoline Logo" style="height: 45px; margin-bottom: 4pt;"><br>
          <span style="font-size: 9pt;">Date: <span id="pdfDate">Auto input date</span></span>
        </td>
      </tr>
    </table>

    <!-- Body Content -->
    <p style="margin-bottom: 0;"><strong>Account:</strong></p>
    <p style="margin-top: 2pt;"><span id="pdfAccountName">Enter Account Name</span></p>

    <p style="margin-bottom: 0;"><strong>Attention:</strong></p>
    <p style="margin-top: 2pt;"><span id="pdfAttention">Attention</span></p>

    <p style="margin-bottom: 0;"><strong>CC:</strong></p>
    <p style="margin-top: 2pt;"><span id="pdfCC">CC</span></p>

    <p style="margin-top: 12pt;"><strong>Dear <span id="pdfAudienceName">Audience Name</span>,</strong></p>

    <p id="pdfOpening">
      I appreciate your support this week while I visited your district. I wanted to take a moment to express my gratitude for the opportunity to conduct training sessions at the following location(s):
    </p>

    <ul style="margin-top: -6pt; margin-bottom: 12pt;">
      <li><span id="pdfLocations">List the locations you visited</span></li>
    </ul>

    <p style="margin-bottom: 0;"><strong>The sessions were designed to provide training on the following topics:</strong></p>
    <ul style="margin-top: 6pt; margin-bottom: 12pt;">
      <li><span id="pdfTopics">What topics were covered in your training visit?</span></li>
      <li><span id="pdfTrainingType">Type of training (in-store/ classroom) and total headcount.</span></li>
    </ul>

    <p style="margin-bottom: 0;"><strong>The training resulted in the following key achievements:</strong></p>
    <ul style="margin-top: 6pt; margin-bottom: 12pt;">
      <li><span id="pdfAchievements">Enter visit details.</span></li>
    </ul>

    <p style="margin-bottom: 0;"><strong>Additionally, we identified some areas for improvement and opportunities for further training:</strong></p>
    <ul style="margin-top: 6pt; margin-bottom: 12pt;">
      <li><span id="pdfOpportunities">Enter opportunities for improvement.</span></li>
    </ul>

    <p style="margin-bottom: 0;"><strong>Follow-Ups:</strong></p>
    <ul style="margin-top: 6pt; margin-bottom: 12pt;">
      <li><span id="pdfFollowUps">Enter Follow ups and the party responsible.</span></li>
    </ul>

    <p id="pdfClosing">
      Once again, I would like to express my gratitude for the opportunity to conduct these training sessions at [Location 1], [Location 2], and [Location 3]. If there is anything else you need or if you have any questions, please don't hesitate to reach out.
    </p>

    <!-- Signature -->
    <p style="margin-top: 24pt;">Sincerely,</p>

    <p>
      <span id="pdfFTSNameRepeat">Neal McGlinchey</span>
    </p>

    <!-- Footer -->
    <div style="text-align: center; margin-top: 48pt;">
      <img src="https://raw.githubusercontent.com/nfmcglinchey/Recap/main/GBL_Valvoline_Logo_positive_RGB.jpg" alt="Valvoline Logo" style="height: 45px;"><br>
      <span style="font-size: 10pt; color: #555;">
        Valvoline Global Operations | 100 Valvoline Way, Suite 200 | Lexington, KY 40509 | valvolineglobal.com
      </span>
    </div>
  </div>
</div>

  </body>
</html>
